Sub InserirFormulasCOUNTIF()
    Dim wsProg As Worksheet
    Dim valor As Integer
    Dim formulaBase As String
    Dim argSeparator As String
    
    ' Define a planilha PROG_CARTELAS
    Set wsProg = ThisWorkbook.Sheets("PROG_CARTELAS")
    
    ' Limpa as células B1:H1 antes de inserir as novas fórmulas
    wsProg.Range("B1:H1").ClearContents
    
    ' Detecta o separador de argumentos correto ("," ou ";")
    argSeparator = Application.International(xlListSeparator)
    
    ' Loop para inserir a fórmula de contagem para valores de 1 a 7
    For valor = 1 To 7
        ' Monta a fórmula usando SUMPRODUCT para contar os valores nas planilhas C1 a C64
        formulaBase = "=SUMPRODUCT("
        
        ' Adiciona a lógica do COUNTIF nas planilhas de C1 a C64
        formulaBase = formulaBase & "("
        
        ' Adiciona o intervalo de cada planilha na fórmula
        formulaBase = formulaBase & "'C1:C64'!2:2=" & valor
        
        ' Fecha a fórmula
        formulaBase = formulaBase & "))"
		
		
		' Verifica se a fórmula está correta
        Debug.Print "Fórmula gerada para valor " & valor & ": " & formulaBase
        
        ' Insere a fórmula nas colunas B até H da linha 1 (B1 = valor 1, C1 = valor 2, etc.)
        wsProg.Cells(1, valor + 1).Formula = formulaBase
    Next valor
    
    MsgBox "As fórmulas COUNTIF foram inseridas com sucesso na linha 1 da planilha PROG_CARTELAS!", vbInformation
End Sub



'Fórmula para valor 1: =SUM(COUNTIF('C1'!2:2;1)+COUNTIF('C2'!2:2;1)+COUNTIF('C3'!2:2;1)+COUNTIF('C4'!2:2;1)+COUNTIF('C5'!2:2;1)+COUNTIF('C6'!2:2;1)+COUNTIF('C7'!2:2;1)+COUNTIF('C8'!2:2;1)+COUNTIF('C9'!2:2;1)+COUNTIF('C10'!2:2;1)+COUNTIF('C11'!2:2;1)+COUNTIF('C12'!2:2;1)+COUNTIF('C13'!2:2;1)+COUNTIF('C14'!2:2;1)+COUNTIF('C15'!2:2;1)+COUNTIF('C16'!2:2;1)+COUNTIF('C17'!2:2;1)+COUNTIF('C18'!2:2;1)+COUNTIF('C19'!2:2;1)+COUNTIF('C20'!2:2;1)+COUNTIF('C21'!2:2;1)+COUNTIF('C22'!2:2;1)+COUNTIF('C23'!2:2;1)+COUNTIF('C24'!2:2;1)+COUNTIF('C25'!2:2;1)+COUNTIF('C26'!2:2;1)+COUNTIF('C27'!2:2;1)+COUNTIF('C28'!2:2;1)+COUNTIF('C29'!2:2;1)+COUNTIF('C30'!2:2;1)+COUNTIF('C31'!2:2;1)+COUNTIF('C32'!2:2;1)+COUNTIF('C33'!2:2;1)+COUNTIF('C34'!2:2;1)+COUNTIF('C35'!2:2;1)+COUNTIF('C36'!2:2;1)+COUNTIF('C37'!2:2;1)+COUNTIF('C38'!2:2;1)+COUNTIF('C39'!2:2;1)+COUNTIF('C40'!2:2;1)+COUNTIF('C41'!2:2;1)+COUNTIF('C42'!2:2;1)+COUNTIF('C43'!2:2;1)+COUNTIF('C44'!2:2;1)+COUNTIF('C45'!2:2;1)+COUNTIF('C46'!2:2;1)+COUNTIF('C47'!2:2;1)+COUNTIF('C48'!2:2;
'1)+COUNTIF('C49'!2:2;1)+COUNTIF('C50'!2:2;1)+COUNTIF('C51'!2:2;1)+COUNTIF('C52'!2:2;1)+COUNTIF('C53'!2:2;1)+COUNTIF('C54'!2:2;1)+COUNTIF('C55'!2:2;1)+COUNTIF('C56'!2:2;1)+COUNTIF('C57'!2:2;1)+COUNTIF('C58'!2:2;1)+COUNTIF('C59'!2:2;1)+COUNTIF('C60'!2:2;1)+COUNTIF('C61'!2:2;1)+COUNTIF('C62'!2:2;1)+COUNTIF('C63'!2:2;1)+COUNTIF('C64'!2:2;1))


=SUM(COUNTIF('C1'!2:2;1)+COUNTIF('C2'!2:2;1)+COUNTIF('C3'!2:2;1)+COUNTIF('C4'!2:2;1)+COUNTIF('C5'!2:2;1)+COUNTIF('C6'!2:2;1)+COUNTIF('C7'!2:2;1)+COUNTIF('C8'!2:2;1)+COUNTIF('C9'!2:2;1)+COUNTIF('C10'!2:2;1)+COUNTIF('C11'!2:2;1)+COUNTIF('C12'!2:2;1)+COUNTIF('C13'!2:2;1)+COUNTIF('C14'!2:2;1)+COUNTIF('C15'!2:2;1)+COUNTIF('C16'!2:2;1)+COUNTIF('C17'!2:2;1)+COUNTIF('C18'!2:2;1)+COUNTIF('C19'!2:2;1)+COUNTIF('C20'!2:2;1)+COUNTIF('C21'!2:2;1)+COUNTIF('C22'!2:2;1)+COUNTIF('C23'!2:2;1)+COUNTIF('C24'!2:2;1)+COUNTIF('C25'!2:2;1)+COUNTIF('C26'!2:2;1)+COUNTIF('C27'!2:2;1)+COUNTIF('C28'!2:2;1)+COUNTIF('C29'!2:2;1)+COUNTIF('C30'!2:2;1)+COUNTIF('C31'!2:2;1)+COUNTIF('C32'!2:2;1)+COUNTIF('C33'!2:2;1)+COUNTIF('C34'!2:2;1)+COUNTIF('C35'!2:2;1)+COUNTIF('C36'!2:2;1)+COUNTIF('C37'!2:2;1)+COUNTIF('C38'!2:2;1)+COUNTIF('C39'!2:2;1)+COUNTIF('C40'!2:2;1)+COUNTIF('C41'!2:2;1)+COUNTIF('C42'!2:2;1)+COUNTIF('C43'!2:2;1)+COUNTIF('C44'!2:2;1)+COUNTIF('C45'!2:2;1)+COUNTIF('C46'!2:2;1)+COUNTIF('C47'!2:2;1)+COUNTIF('C48'!2:2;1)+COUNTIF('C49'!2:2;1)+COUNTIF('C50'!2:2;1)+COUNTIF('C51'!2:2;1)+COUNTIF('C52'!2:2;1)+COUNTIF('C53'!2:2;1)+COUNTIF('C54'!2:2;1)+COUNTIF('C55'!2:2;1)+COUNTIF('C56'!2:2;1)+COUNTIF('C57'!2:2;1)+COUNTIF('C58'!2:2;1)+COUNTIF('C59'!2:2;1)+COUNTIF('C60'!2:2;1)+COUNTIF('C61'!2:2;1)+COUNTIF('C62'!2:2;1)+COUNTIF('C63'!2:2;1)+COUNTIF('C64'!2:2;1))
=SUM(COUNTIF('C1'!2:2;2)+COUNTIF('C2'!2:2;2)+COUNTIF('C3'!2:2;2)+COUNTIF('C4'!2:2;2)+COUNTIF('C5'!2:2;2)+COUNTIF('C6'!2:2;2)+COUNTIF('C7'!2:2;2)+COUNTIF('C8'!2:2;2)+COUNTIF('C9'!2:2;2)+COUNTIF('C10'!2:2;2)+COUNTIF('C11'!2:2;2)+COUNTIF('C12'!2:2;2)+COUNTIF('C13'!2:2;2)+COUNTIF('C14'!2:2;2)+COUNTIF('C15'!2:2;2)+COUNTIF('C16'!2:2;2)+COUNTIF('C17'!2:2;2)+COUNTIF('C18'!2:2;2)+COUNTIF('C19'!2:2;2)+COUNTIF('C20'!2:2;2)+COUNTIF('C21'!2:2;2)+COUNTIF('C22'!2:2;2)+COUNTIF('C23'!2:2;2)+COUNTIF('C24'!2:2;2)+COUNTIF('C25'!2:2;2)+COUNTIF('C26'!2:2;2)+COUNTIF('C27'!2:2;2)+COUNTIF('C28'!2:2;2)+COUNTIF('C29'!2:2;2)+COUNTIF('C30'!2:2;2)+COUNTIF('C31'!2:2;2)+COUNTIF('C32'!2:2;2)+COUNTIF('C33'!2:2;2)+COUNTIF('C34'!2:2;2)+COUNTIF('C35'!2:2;2)+COUNTIF('C36'!2:2;2)+COUNTIF('C37'!2:2;2)+COUNTIF('C38'!2:2;2)+COUNTIF('C39'!2:2;2)+COUNTIF('C40'!2:2;2)+COUNTIF('C41'!2:2;2)+COUNTIF('C42'!2:2;2)+COUNTIF('C43'!2:2;2)+COUNTIF('C44'!2:2;2)+COUNTIF('C45'!2:2;2)+COUNTIF('C46'!2:2;2)+COUNTIF('C47'!2:2;2)+COUNTIF('C48'!2:2;2)+COUNTIF('C49'!2:2;2)+COUNTIF('C50'!2:2;2)+COUNTIF('C51'!2:2;2)+COUNTIF('C52'!2:2;2)+COUNTIF('C53'!2:2;2)+COUNTIF('C54'!2:2;2)+COUNTIF('C55'!2:2;2)+COUNTIF('C56'!2:2;2)+COUNTIF('C57'!2:2;2)+COUNTIF('C58'!2:2;2)+COUNTIF('C59'!2:2;2)+COUNTIF('C60'!2:2;2)+COUNTIF('C61'!2:2;2)+COUNTIF('C62'!2:2;2)+COUNTIF('C63'!2:2;2)+COUNTIF('C64'!2:2;2))
=SUM(COUNTIF('C1'!2:2;3)+COUNTIF('C2'!2:2;3)+COUNTIF('C3'!2:2;3)+COUNTIF('C4'!2:2;3)+COUNTIF('C5'!2:2;3)+COUNTIF('C6'!2:2;3)+COUNTIF('C7'!2:2;3)+COUNTIF('C8'!2:2;3)+COUNTIF('C9'!2:2;3)+COUNTIF('C10'!2:2;3)+COUNTIF('C11'!2:2;3)+COUNTIF('C12'!2:2;3)+COUNTIF('C13'!2:2;3)+COUNTIF('C14'!2:2;3)+COUNTIF('C15'!2:2;3)+COUNTIF('C16'!2:2;3)+COUNTIF('C17'!2:2;3)+COUNTIF('C18'!2:2;3)+COUNTIF('C19'!2:2;3)+COUNTIF('C20'!2:2;3)+COUNTIF('C21'!2:2;3)+COUNTIF('C22'!2:2;3)+COUNTIF('C23'!2:2;3)+COUNTIF('C24'!2:2;3)+COUNTIF('C25'!2:2;3)+COUNTIF('C26'!2:2;3)+COUNTIF('C27'!2:2;3)+COUNTIF('C28'!2:2;3)+COUNTIF('C29'!2:2;3)+COUNTIF('C30'!2:2;3)+COUNTIF('C31'!2:2;3)+COUNTIF('C32'!2:2;3)+COUNTIF('C33'!2:2;3)+COUNTIF('C34'!2:2;3)+COUNTIF('C35'!2:2;3)+COUNTIF('C36'!2:2;3)+COUNTIF('C37'!2:2;3)+COUNTIF('C38'!2:2;3)+COUNTIF('C39'!2:2;3)+COUNTIF('C40'!2:2;3)+COUNTIF('C41'!2:2;3)+COUNTIF('C42'!2:2;3)+COUNTIF('C43'!2:2;3)+COUNTIF('C44'!2:2;3)+COUNTIF('C45'!2:2;3)+COUNTIF('C46'!2:2;3)+COUNTIF('C47'!2:2;3)+COUNTIF('C48'!2:2;3)+COUNTIF('C49'!2:2;3)+COUNTIF('C50'!2:2;3)+COUNTIF('C51'!2:2;3)+COUNTIF('C52'!2:2;3)+COUNTIF('C53'!2:2;3)+COUNTIF('C54'!2:2;3)+COUNTIF('C55'!2:2;3)+COUNTIF('C56'!2:2;3)+COUNTIF('C57'!2:2;3)+COUNTIF('C58'!2:2;3)+COUNTIF('C59'!2:2;3)+COUNTIF('C60'!2:2;3)+COUNTIF('C61'!2:2;3)+COUNTIF('C62'!2:2;3)+COUNTIF('C63'!2:2;3)+COUNTIF('C64'!2:2;3))
=SUM(COUNTIF('C1'!2:2;4)+COUNTIF('C2'!2:2;4)+COUNTIF('C3'!2:2;4)+COUNTIF('C4'!2:2;4)+COUNTIF('C5'!2:2;4)+COUNTIF('C6'!2:2;4)+COUNTIF('C7'!2:2;4)+COUNTIF('C8'!2:2;4)+COUNTIF('C9'!2:2;4)+COUNTIF('C10'!2:2;4)+COUNTIF('C11'!2:2;4)+COUNTIF('C12'!2:2;4)+COUNTIF('C13'!2:2;4)+COUNTIF('C14'!2:2;4)+COUNTIF('C15'!2:2;4)+COUNTIF('C16'!2:2;4)+COUNTIF('C17'!2:2;4)+COUNTIF('C18'!2:2;4)+COUNTIF('C19'!2:2;4)+COUNTIF('C20'!2:2;4)+COUNTIF('C21'!2:2;4)+COUNTIF('C22'!2:2;4)+COUNTIF('C23'!2:2;4)+COUNTIF('C24'!2:2;4)+COUNTIF('C25'!2:2;4)+COUNTIF('C26'!2:2;4)+COUNTIF('C27'!2:2;4)+COUNTIF('C28'!2:2;4)+COUNTIF('C29'!2:2;4)+COUNTIF('C30'!2:2;4)+COUNTIF('C31'!2:2;4)+COUNTIF('C32'!2:2;4)+COUNTIF('C33'!2:2;4)+COUNTIF('C34'!2:2;4)+COUNTIF('C35'!2:2;4)+COUNTIF('C36'!2:2;4)+COUNTIF('C37'!2:2;4)+COUNTIF('C38'!2:2;4)+COUNTIF('C39'!2:2;4)+COUNTIF('C40'!2:2;4)+COUNTIF('C41'!2:2;4)+COUNTIF('C42'!2:2;4)+COUNTIF('C43'!2:2;4)+COUNTIF('C44'!2:2;4)+COUNTIF('C45'!2:2;4)+COUNTIF('C46'!2:2;4)+COUNTIF('C47'!2:2;4)+COUNTIF('C48'!2:2;4)+COUNTIF('C49'!2:2;4)+COUNTIF('C50'!2:2;4)+COUNTIF('C51'!2:2;4)+COUNTIF('C52'!2:2;4)+COUNTIF('C53'!2:2;4)+COUNTIF('C54'!2:2;4)+COUNTIF('C55'!2:2;4)+COUNTIF('C56'!2:2;4)+COUNTIF('C57'!2:2;4)+COUNTIF('C58'!2:2;4)+COUNTIF('C59'!2:2;4)+COUNTIF('C60'!2:2;4)+COUNTIF('C61'!2:2;4)+COUNTIF('C62'!2:2;4)+COUNTIF('C63'!2:2;4)+COUNTIF('C64'!2:2;4))
=SUM(COUNTIF('C1'!2:2;5)+COUNTIF('C2'!2:2;5)+COUNTIF('C3'!2:2;5)+COUNTIF('C4'!2:2;5)+COUNTIF('C5'!2:2;5)+COUNTIF('C6'!2:2;5)+COUNTIF('C7'!2:2;5)+COUNTIF('C8'!2:2;5)+COUNTIF('C9'!2:2;5)+COUNTIF('C10'!2:2;5)+COUNTIF('C11'!2:2;5)+COUNTIF('C12'!2:2;5)+COUNTIF('C13'!2:2;5)+COUNTIF('C14'!2:2;5)+COUNTIF('C15'!2:2;5)+COUNTIF('C16'!2:2;5)+COUNTIF('C17'!2:2;5)+COUNTIF('C18'!2:2;5)+COUNTIF('C19'!2:2;5)+COUNTIF('C20'!2:2;5)+COUNTIF('C21'!2:2;5)+COUNTIF('C22'!2:2;5)+COUNTIF('C23'!2:2;5)+COUNTIF('C24'!2:2;5)+COUNTIF('C25'!2:2;5)+COUNTIF('C26'!2:2;5)+COUNTIF('C27'!2:2;5)+COUNTIF('C28'!2:2;5)+COUNTIF('C29'!2:2;5)+COUNTIF('C30'!2:2;5)+COUNTIF('C31'!2:2;5)+COUNTIF('C32'!2:2;5)+COUNTIF('C33'!2:2;5)+COUNTIF('C34'!2:2;5)+COUNTIF('C35'!2:2;5)+COUNTIF('C36'!2:2;5)+COUNTIF('C37'!2:2;5)+COUNTIF('C38'!2:2;5)+COUNTIF('C39'!2:2;5)+COUNTIF('C40'!2:2;5)+COUNTIF('C41'!2:2;5)+COUNTIF('C42'!2:2;5)+COUNTIF('C43'!2:2;5)+COUNTIF('C44'!2:2;5)+COUNTIF('C45'!2:2;5)+COUNTIF('C46'!2:2;5)+COUNTIF('C47'!2:2;5)+COUNTIF('C48'!2:2;5)+COUNTIF('C49'!2:2;5)+COUNTIF('C50'!2:2;5)+COUNTIF('C51'!2:2;5)+COUNTIF('C52'!2:2;5)+COUNTIF('C53'!2:2;5)+COUNTIF('C54'!2:2;5)+COUNTIF('C55'!2:2;5)+COUNTIF('C56'!2:2;5)+COUNTIF('C57'!2:2;5)+COUNTIF('C58'!2:2;5)+COUNTIF('C59'!2:2;5)+COUNTIF('C60'!2:2;5)+COUNTIF('C61'!2:2;5)+COUNTIF('C62'!2:2;5)+COUNTIF('C63'!2:2;5)+COUNTIF('C64'!2:2;5))
=SUM(COUNTIF('C1'!2:2;6)+COUNTIF('C2'!2:2;6)+COUNTIF('C3'!2:2;6)+COUNTIF('C4'!2:2;6)+COUNTIF('C5'!2:2;6)+COUNTIF('C6'!2:2;6)+COUNTIF('C7'!2:2;6)+COUNTIF('C8'!2:2;6)+COUNTIF('C9'!2:2;6)+COUNTIF('C10'!2:2;6)+COUNTIF('C11'!2:2;6)+COUNTIF('C12'!2:2;6)+COUNTIF('C13'!2:2;6)+COUNTIF('C14'!2:2;6)+COUNTIF('C15'!2:2;6)+COUNTIF('C16'!2:2;6)+COUNTIF('C17'!2:2;6)+COUNTIF('C18'!2:2;6)+COUNTIF('C19'!2:2;6)+COUNTIF('C20'!2:2;6)+COUNTIF('C21'!2:2;6)+COUNTIF('C22'!2:2;6)+COUNTIF('C23'!2:2;6)+COUNTIF('C24'!2:2;6)+COUNTIF('C25'!2:2;6)+COUNTIF('C26'!2:2;6)+COUNTIF('C27'!2:2;6)+COUNTIF('C28'!2:2;6)+COUNTIF('C29'!2:2;6)+COUNTIF('C30'!2:2;6)+COUNTIF('C31'!2:2;6)+COUNTIF('C32'!2:2;6)+COUNTIF('C33'!2:2;6)+COUNTIF('C34'!2:2;6)+COUNTIF('C35'!2:2;6)+COUNTIF('C36'!2:2;6)+COUNTIF('C37'!2:2;6)+COUNTIF('C38'!2:2;6)+COUNTIF('C39'!2:2;6)+COUNTIF('C40'!2:2;6)+COUNTIF('C41'!2:2;6)+COUNTIF('C42'!2:2;6)+COUNTIF('C43'!2:2;6)+COUNTIF('C44'!2:2;6)+COUNTIF('C45'!2:2;6)+COUNTIF('C46'!2:2;6)+COUNTIF('C47'!2:2;6)+COUNTIF('C48'!2:2;6)+COUNTIF('C49'!2:2;6)+COUNTIF('C50'!2:2;6)+COUNTIF('C51'!2:2;6)+COUNTIF('C52'!2:2;6)+COUNTIF('C53'!2:2;6)+COUNTIF('C54'!2:2;6)+COUNTIF('C55'!2:2;6)+COUNTIF('C56'!2:2;6)+COUNTIF('C57'!2:2;6)+COUNTIF('C58'!2:2;6)+COUNTIF('C59'!2:2;6)+COUNTIF('C60'!2:2;6)+COUNTIF('C61'!2:2;6)+COUNTIF('C62'!2:2;6)+COUNTIF('C63'!2:2;6)+COUNTIF('C64'!2:2;6))
=SUM(COUNTIF('C1'!2:2;7)+COUNTIF('C2'!2:2;7)+COUNTIF('C3'!2:2;7)+COUNTIF('C4'!2:2;7)+COUNTIF('C5'!2:2;7)+COUNTIF('C6'!2:2;7)+COUNTIF('C7'!2:2;7)+COUNTIF('C8'!2:2;7)+COUNTIF('C9'!2:2;7)+COUNTIF('C10'!2:2;7)+COUNTIF('C11'!2:2;7)+COUNTIF('C12'!2:2;7)+COUNTIF('C13'!2:2;7)+COUNTIF('C14'!2:2;7)+COUNTIF('C15'!2:2;7)+COUNTIF('C16'!2:2;7)+COUNTIF('C17'!2:2;7)+COUNTIF('C18'!2:2;7)+COUNTIF('C19'!2:2;7)+COUNTIF('C20'!2:2;7)+COUNTIF('C21'!2:2;7)+COUNTIF('C22'!2:2;7)+COUNTIF('C23'!2:2;7)+COUNTIF('C24'!2:2;7)+COUNTIF('C25'!2:2;7)+COUNTIF('C26'!2:2;7)+COUNTIF('C27'!2:2;7)+COUNTIF('C28'!2:2;7)+COUNTIF('C29'!2:2;7)+COUNTIF('C30'!2:2;7)+COUNTIF('C31'!2:2;7)+COUNTIF('C32'!2:2;7)+COUNTIF('C33'!2:2;7)+COUNTIF('C34'!2:2;7)+COUNTIF('C35'!2:2;7)+COUNTIF('C36'!2:2;7)+COUNTIF('C37'!2:2;7)+COUNTIF('C38'!2:2;7)+COUNTIF('C39'!2:2;7)+COUNTIF('C40'!2:2;7)+COUNTIF('C41'!2:2;7)+COUNTIF('C42'!2:2;7)+COUNTIF('C43'!2:2;7)+COUNTIF('C44'!2:2;7)+COUNTIF('C45'!2:2;7)+COUNTIF('C46'!2:2;7)+COUNTIF('C47'!2:2;7)+COUNTIF('C48'!2:2;7)+COUNTIF('C49'!2:2;7)+COUNTIF('C50'!2:2;7)+COUNTIF('C51'!2:2;7)+COUNTIF('C52'!2:2;7)+COUNTIF('C53'!2:2;7)+COUNTIF('C54'!2:2;7)+COUNTIF('C55'!2:2;7)+COUNTIF('C56'!2:2;7)+COUNTIF('C57'!2:2;7)+COUNTIF('C58'!2:2;7)+COUNTIF('C59'!2:2;7)+COUNTIF('C60'!2:2;7)+COUNTIF('C61'!2:2;7)+COUNTIF('C62'!2:2;7)+COUNTIF('C63'!2:2;7)+COUNTIF('C64'!2:2;7))


'Fórmula gerada para valor 1: =SUMPRODUCT(('C1:C64'!2:2=1))
'Fórmula gerada para valor 2: =SUMPRODUCT(('C1:C64'!2:2=2))
'Fórmula gerada para valor 3: =SUMPRODUCT(('C1:C64'!2:2=3))
'Fórmula gerada para valor 4: =SUMPRODUCT(('C1:C64'!2:2=4))
'Fórmula gerada para valor 5: =SUMPRODUCT(('C1:C64'!2:2=5))
'Fórmula gerada para valor 6: =SUMPRODUCT(('C1:C64'!2:2=6))
'Fórmula gerada para valor 7: =SUMPRODUCT(('C1:C64'!2:2=7))
